<script>
    const CSV_URL = 'leaderboard.csv';
    Papa.parse(CSV_URL, {
        download: true, 
        header: true,
        skipEmptyLines: true, // Crucial to skip those blank lines!
        transformHeader: function(h) { return h.trim().toLowerCase(); }, // Cleans 'model ' to 'model'
        complete: function(results) {
            const data = results.data.filter(row => row.team);
            data.sort((a, b) => parseFloat(b.score) - parseFloat(a.score));
            
            const body = document.getElementById('lb-body');
            body.innerHTML = ''; // Clear previous content
            
            data.forEach((row, i) => {
                const scoreValue = parseFloat(row.score) || 0;
                const scoreWidth = (scoreValue * 100).toFixed(1);
                
                // Use row.model (trimmed)
                const modelDisplay = row.model ? row.model.trim() : 'Baseline';
                
                body.innerHTML += `
                    <tr>
                        <td class="${i===0 ? 'rank-1' : ''}">${i + 1}</td>
                        <td>${row.team}</td>
                        <td>
                            <div class="bar-container"><div class="bar-fill" style="width: ${scoreWidth}%"></div></div>
                            ${scoreValue.toFixed(4)}
                        </td>
                        <td><code>${modelDisplay}</code></td>
                        <td>${row.date}</td>
                    </tr>`;
            });
        }
    });
</script>
